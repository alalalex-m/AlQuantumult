# 四、网络层

## 网络层的作用（分组）

### 网络层的目的是实现两个端系统之间的数据透明传送，具体功能包括寻址和路由选择、连接的建立、保持和终止等。它提供的服务使传输层不需要了解网络中的数据传输和交换技术。

- 提供点到点服务

## 网际层协议IP

### ARP地址解析协议

- 根据IP地址获取物理地址

### RARP反地址解析协议

### ICMP网际控制报文协议

- 通过ICMP传输控制消息，控制消息是指网络通不通、主机是否可达、路由是否可用等网络本身的消息。ping

### IGMP网际组管理协议

- 是用于管理网路协议多播组成员的一种通信协议。IP主机和相邻的路由器利用IGMP来创建多播组的组成员。组播方式解决了单播情况下数据的重复拷贝及带宽的重复占用，也解决了广播方式下带宽资源的浪费。

## IP地址

### IP地址的概念

- IP地址

	- IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，以此来屏蔽物理地址的差异。

- 组成

	- 一个IP地址由4个字节，32位组成，一般用点分十进制的方式表现。

		- 0.0.0.0
		- 10000000.00000000.00000000.00000000
		- 128.0.0.0

- IP地址和MAC地址的区别

	- 1.IP地址是一个逻辑地址，MAC地址是物理地址
2.MAC地址是唯一的但是IP地址不是唯一的
3.MAC地址主要是工作在第二层，IP地址在网络层
4.MAC地址是48位，IP地址一般是32位（v6是128位）
5.IP地址的分配取决于网络拓扑，MAC地址分配取决于制造商。

### IP地址的组成

- 主机地址/主机号

	- 标识某一台设备的地址

- 网络地址/网络号

	- 标识某一个网段的地址

- 子网掩码

	- 区分网络号和主机号
	- 它是一种用来指明一个IP地址的哪些位标识的是主机所在的子网，以及哪些位标识的是主机的位掩码。子网掩码不能单独存在，它必须结合IP地址一起使用。子网掩码只有一个作用，就是将某个IP地址划分成网络地址和主机地址两部分。
	- 网络掩码一般与IP地址结合使用，其中值为1的比特对应IP地址中的网络位；值为0的
比特对应IP地址中的主机位，以此来辅助我们识别一个IP地址中的网络位与主机位。
即网络掩码中1的个数就是IP地址的网络号的位数，0的个数就是IP地址的主机号的位
数。

### IP地址的分类

- A类

	- 一个A类IP地址是指， 在IP地址的四段号码中，第一段号码为网络号码，剩下的三段号码为本地计算机的号码。A类IP地址中网络的标识长度为8位，主机标识的长度为24位，A类网络地址数量较少，有126个网络，每个网络可以容纳主机数达1600多万台。
A类IP地址 地址范围1.0.0.1到127.255.255.254。
子网掩码：255.0.0.0

		- 第一个字节为网络号，第一个字节第一位是0

- B类

	- 一个B类IP地址是指，在IP地址的四段号码中，前两段号码为网络号码。B类IP地址中网络的标识长度为16位，主机标识的长度为16位，B类网络地址适用于中等规模的网络，有16384个网络，每个网络所能容纳的计算机数为6万多台。
B类IP地址地址范围128.0.0.1-191.255.255.254。
子网掩码：255.255.0.0

		- 前两个字节为网络号，第一个字节前两位是10

- C类

	- 一个C类IP地址是指，在IP地址的四段号码中，前三段号码为网络号码，剩下的一段号码为本地计算机的号码。C类IP地址中网络的标识长度为24位，主机标识的长度为8位，C类网络地址数量较多，有209万余个网络。适用于小规模的局域网络，每个网络最多只能包含254台计算机。
C类IP地址范围192.0.0.1-223.255.255.254。
子网掩码：255.255.255.0

		- 前三个字节为网络号，第一个字节前两位是110

- D类

	- D类IP地址在历史上被叫做多播地址，即组播地址。在以太网中，多播地址命名了一组应该在这个网络中应用接收到一个分组的站点。多播地址的最高位必须是“1110”，范围从224.0.0.0到239.255.255.255。


- E类

	- 保留

- 特殊地址

	- 网络地址

		- 主机号全0

	- 广播地址

		- 主机号全1

	- 回环地址

		- 127.0.0.0

### IPv6

- 因为IPv4地址满足不了需求，出现匮乏的情况，所以诞生了IPv6地址继续使用。v6地址由128位，16个字节组成，一般表现形式为十六进制。

## 子网划分

### 子网划分

- 概念：因此可以利用子网划分来减少地址浪费，即VLSM (Variable Length Subnet Mask)，可变
长子网掩码。将-个大的有类网络，划分成若干个小的子网，使得IP地址的使用更为科学。
- 通过修改子网掩码，起到更加精细划分网络号和主机号的作用。
- 网络掩码一般与IP地址结合使用，其中值为1的比特对应IP地址中的网络位；值为0的比特对应IP地址中的主机位，以此来辅助我们识别一个IP地址中的网络位与主机位。即网络掩码中1的个数就是IP地址的网络号的位数，0的个数就是IP地址的主机号的位
数。

### VLSM

- VLSM(可变长子网掩码) 是为了有效的使用无类别域间路由（CIDR）和路由汇聚(route summary)来控制路由表的大小，它是网络管理员常用的IP寻址技术，VLSM就是其中的常用方式，可以对子网进行层次化编址，以便最有效的利用现有的地址空间。

### 给你IP地址和子网掩码，求网段

### 有类地址

## 网络层的路由

### 路由

- 路由是什么？

	- 路由（routing）是指分组从源到目的地时，决定端到端路径的网络范围的进程 。路由是指导报文转发的路径信息，通过路由可以确认转发IP报文的路径。

		- 路由是网络层最主要的工作任务

- 路由器

	- 网络层的基本设备。
	- 数据转发
	- 一个端口代表一个网段，路由器中存放着通往各个网段的表格，叫做路由表。

- 路由表（routing table）或称路由择域信息库（RIB, Routing Information Base），是一个存储在路由器或者联网计算机中的电子表格（文件）或类数据库。路由表存储着指向特定网络地址的路径
- 网关

	- 网关(Gateway)又称网间连接器、协议转换器。用于两个高层协议不同的网络互连。网关既可以用于广域网互连，也可以用于局域网互连。

- 路由获取方式

	- 直连路由
	- 静态路由
	- 动态路由

### 路由的配置方式

- 静态路由

	- 静态路由

		- 由管理员手工配置、配置方便，对系统要求低，适用于拓扑结构简单稳定的小型网络。

	- 缺省路由

		- 是一种特殊的路由，当报文没有在路由表中找到匹配的具体表项时才能使用的路由。

- 动态路由

	- 动态路由

		- 通过动态路由协议来实现不同网段的路由互通
		- 动态路由协议由自己的路由算法，能够自动适应网络拓扑的变化，适用于具有一定数量的三层设备的网络。

	- 动态路由协议

		- RIP*

			- RIP（路由信息协议）
			- 基于矢量（跳数）的动态路由协议
			- 适用于中小规模的网络拓扑，最大跳数为15

		- OSPF*

			- OSPF（开放式最短路径优先）
			- 基于链路状态的协议
			- 使用SPF算法，计算最短路径。树形协议。
			- 天生防止环路生成

		- BGP

			- BGP是自治系统间的路由协议。自治系统之间的路由协议。

				- 自治系统间的路由协议

		- IS-IS

			- IS-IS（Intermediate System-to-Intermediate System，中间系统到中间系统）与OSPF类似，通。IS-IS是基于路由路划分区域、OSPF利用接口划分。

				- 内部网关协议

		- RIP和OSPF的区别：

			- 1.RIP是基于矢量的协议，OSPF是基于链路状态.
2.RIP适用于中小型网络拓扑，OSPF适用于较大规模的网络.
3.OSPF支持可变长度子网掩码（VLSM），RIP不支持.
4.OSPF的收敛速度比RIP的更加迅速.
			- OSPF防环
RIP不防环

